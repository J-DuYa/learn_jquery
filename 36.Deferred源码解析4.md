#### Deferred.then()的实现

```javascript
jQuery.extend({
	Deferred: function (func) {
		var tuples = [
				["resolve", "done", jQuery.Callbacks("once memory"), "resolved"],
				["reject", "fail", jQuery.Callbacks("once memory"), "rejected"],
				["notify", "progress", jQuery.Callbacks("memory")]
			],
			promise = {
				then: function (/* fnDone, fnFail, fnProgress */) {
					// fns = [fnDone, fnFail, fnProgress]
					var fns = arguments;
					return jQuery.Deferred(function (newDefer) {
						jQuery.each(tuples, function (i, tuple) {
							// fn = fnDone | fnFail | fnProgress
							var fn = jQuery.isFunction(fns[i]) && fns[i];

							// deferred.done(fnDone) | deferred.fail(fnFail) | deferred.progress(fnProgress)
							deferred[tuple[1]](fn);
						});
					}).promise();
				}
			},
			deferred = {};

		return deferred;
	}
});
```